<style>
/* 1. 锁定侧边栏整体宽度 */
.sidebar {
    width: 280px !important;
    max-width: 280px !important;
    flex-basis: 280px !important;
}

/* 2. 锁定名言区域的物理空间 */
.sidebar .subtitle, .site-description, .profile-description {
    display: flex !important;      
    align-items: flex-start;        /* 垂直：往上靠 */
    justify-content: flex-start;     /* 水平：往左靠 */
    
    width: 90% !important;
    padding-left: 10px;
    padding-top: 5px;
    margin: 15px auto !important;   /* 固定外边距 */
    
    /* 【核心修复】使用 px 或 rem 替代 em */
    /* 无论内部字号如何变，这个盒子永远是 80px 高 */
    height: 40px !important;       
    min-height: 40px !important;
    max-height: 40px !important;
    
    overflow: hidden !important;    /* 防止极端情况溢出 */
    
    /* 文字排版 */
    text-align: left;
    word-break: break-all;
    white-space: normal !important;
    line-height: 1.4 !important;    /* 行高也尽量固定 */
    
    user-select: none;
    transition: opacity 0.2s ease, font-size 0.2s ease;
}
</style>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const quotes = {{ site.Data.quotes | jsonify | safeJS }};
        const targetSelector = '.sidebar .subtitle, .site-description, .profile-description';
        const subtitleElement = document.querySelector(targetSelector);

        if (Array.isArray(quotes) && quotes.length > 0 && subtitleElement) {
            let currentIndex = 0;

            // 1. 定义一个调整字号的内部函数
            const updateSubtitle = (index) => {
                const text = quotes[index];
                // 动态调整字号
                const weight = text.split('').reduce((acc, char) => {
                    return acc + (char.match(/[^\x00-\xff]/) ? 2 : 1);
                }, 0);
                console.log(weight)
                if (weight > 30) {
                    subtitleElement.style.fontSize = "1.5rem"; // 极长文本
                    // subtitleElement.style.lineHeight = "1.5";
                } else if (weight > 20) {
                    subtitleElement.style.fontSize = "1.8rem"; // 中长文本
                    // subtitleElement.style.lineHeight = "1.2";
                } else {
                    subtitleElement.style.fontSize = "2.1rem"; // 短文本
                    // subtitleElement.style.lineHeight = "0.9";
                }
                subtitleElement.textContent = text;
                if (index === quotes.length - 1) {
                    subtitleElement.style.cursor = "default";
                    subtitleElement.style.opacity = "0.6"; // 稍微变暗
                    subtitleElement.title = "Now You See Me";
                } else {
                    subtitleElement.style.cursor = "pointer";
                    subtitleElement.style.opacity = "1";
                    subtitleElement.title = "Moving Foward?";
                }
            };

            updateSubtitle(currentIndex);

            const handleClick = function () {
                if (currentIndex >= quotes.length - 1) return;

                subtitleElement.style.opacity = 0;
                setTimeout(() => {
                    currentIndex++;
                    updateSubtitle(currentIndex);
                    subtitleElement.style.opacity = 1;
                    
                    if (currentIndex === quotes.length - 1) {
                        subtitleElement.removeEventListener('click', handleClick);
                    }
                }, 200);
            };
            subtitleElement.addEventListener('click', handleClick);
        }
    });
</script>