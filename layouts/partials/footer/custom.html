<style>

    #dark-mode-toggle {
        display: none !important;
    }
    
    .menu-bottom-section {
        display: none !important;
    }

    :root, 
    :root[data-scheme="dark"], 
    body[data-scheme="dark"] {
        /* 【核心】：把所有卡片的背景变量，强行改成半透明黑色 */
        --card-background: rgba(28, 28, 28, 0.6) !important;
        
        /* 把页面主体的背景变量改成透明，确保不遮挡你的壁纸 */
        --body-background: transparent !important;
    }

    /* --- 基础样式（默认针对手机端 Mobile First） --- */
    body {
        /* 1. 图片路径：对应你放在 static/images/ 下的图片 */
        background-image: url('/images/LCLR1_PhotoGrid.png');
        
        /* 2. 确保图片铺满整个屏幕，不留白 */
        background-size: cover;
        
        background-position: center center;
        
        background-repeat: no-repeat;
        
        background-attachment: fixed;

        filter: grayscale(60%);
    }
    
    .sidebar {
        width: 30% !important; /* 跟随主题布局 */
        max-width: 100% !important;
        flex-basis: auto !important;
    }

    .sidebar .subtitle, .site-description, .profile-description {
        display: flex !important;
        align-items: flex-start;    /* 垂直靠上 */
        justify-content: flex-start; /* 水平靠左 */
        
        width: 90% !important;      /* 留出左右边距 */
        margin: 10px auto !important;
        
        /* 【手机端高度】手机屏幕宝贵，给稍微矮一点的固定空间 */
        height: 3.5rem !important;  
        min-height: 3.5rem !important;
        
        padding-left: 5px;          /* 手机端稍微紧凑一点 */
        padding-top: 2px;
        
        overflow: hidden !important; /* 防止溢出 */
        
        /* 文字通用设置 */
        text-align: left;
        word-break: break-all;
        white-space: normal !important;
        line-height: 1.3 !important;
        user-select: none;
        /* transition: opacity 0.2s ease, font-size 0.2s ease; */
    }

    /* --- 电脑/平板端样式（屏幕宽度大于 768px 时触发） --- */
    @media screen and (min-width: 768px) {
        /* 电脑端通常侧边栏是固定的，我们可以给一个更舒适的高度 */
        .sidebar .subtitle, .site-description, .profile-description {
            /* 【电脑端高度】空间充裕，给高一点，容纳更多文字 */
            height: 5rem !important; 
            min-height: 5rem !important;
            
            padding-left: 10px;      /* 电脑端呼吸感更强 */
            padding-top: 5px;
            
            /* 如果你依然想在电脑端限制最大宽度，可以在这里加 */
            /* max-width: 280px; */ 
        }
    }

    .sidebar-qqmusic-container {
        width: 100%;
        height: 0;
        padding-bottom: 80px; /* 预留高度 */
        margin: 15px auto;
        border-radius: 8px;
        overflow: hidden;
        position: relative;
        z-index: 10;
        
        /* 【关键】因为QQ音乐官方播放器太宽，我们需要缩小它 */
        transform-origin: top left;
        transform: scale(0.85); /* 整体缩小到 85% 以适应 280px 宽度 */
        width: 117%; /* 放大容器宽度，抵消缩放带来的留白 (1 / 0.85 ≈ 1.17) */
    }

    .sidebar-qqmusic-container iframe {
        border: none;
        width: 100%;
        height: 450px; /* 歌单列表的高度，可以改小，比如 100px 只显示单曲 */
    }

    /* 我们要把毛玻璃效果加给所有使用了该变量的元素 */
    .article-list article,  /* 首页文章卡片 */
    .main-article,          /* 文章详情页 */
    .widget,                /* 右侧小挂件 (如果有) */
    .menu-modal,            /* 手机端弹出的菜单 */
    .search-modal           /* 搜索框 */
    {
        /* 强制使用我们上面定义的半透明变量 */
        background-color: var(--card-background) !important;
        
        /* 加上毛玻璃和边框 */
        backdrop-filter: blur(12px) !important;
        -webkit-backdrop-filter: blur(12px) !important;
        border: 1px solid rgba(255, 255, 255, 0.08) !important;
        border-radius: 16px !important;
        box-shadow: 0 4px 20px rgba(0,0,0,0.2) !important;
    }
</style>


<script>
    document.addEventListener("DOMContentLoaded", function () {
        const quotes = {{ site.Data.quotes | jsonify | safeJS }};
        const targetSelector = '.sidebar .subtitle, .site-description, .profile-description';
        const subtitleElement = document.querySelector(targetSelector);
        const STORAGE_KEY = 'user_quote_index';

        if (Array.isArray(quotes) && quotes.length > 0 && subtitleElement) {
            let savedIndex = localStorage.getItem(STORAGE_KEY);
            let currentIndex = 0;

            if (savedIndex !== null) {
                currentIndex = parseInt(savedIndex, 10);
                // 安全检查：如果记录的索引超过了现在的名言总数，重置为0
                if (currentIndex >= quotes.length || isNaN(currentIndex)) {
                    currentIndex = 0;
                }
            }

            // 1. 定义一个调整字号的内部函数
            const updateSubtitle = (index) => {
                const text = quotes[index];
                // 动态调整字号
                const weight = text.split('').reduce((acc, char) => {
                    return acc + (char.match(/[^\x00-\xff]/) ? 2 : 1);
                }, 0);
                console.log(weight)
                if (weight > 30) {
                    subtitleElement.style.fontSize = "1.5rem"; // 极长文本
                    // subtitleElement.style.lineHeight = "1.5";
                } else if (weight > 20) {
                    subtitleElement.style.fontSize = "1.8rem"; // 中长文本
                    // subtitleElement.style.lineHeight = "1.2";
                } else {
                    subtitleElement.style.fontSize = "2.1rem"; // 短文本
                    // subtitleElement.style.lineHeight = "0.9";
                }
                subtitleElement.textContent = text;
                subtitleElement.style.cursor = "pointer";
                subtitleElement.style.opacity = "1";
                if (index === quotes.length - 1) {
                    subtitleElement.title = "Now You See Me";
                } else {
                    subtitleElement.title = "Moving Foward?";
                }
                localStorage.setItem(STORAGE_KEY, index);
            };
            
            updateSubtitle(currentIndex);

            const handleClick = function () {
                subtitleElement.style.opacity = 0;
                if (currentIndex >= quotes.length - 1){
                    
                    subtitleElement.style.transition = "opacity 0.3s ease";

                    setTimeout(() => {
                        currentIndex=0;
                        updateSubtitle(currentIndex);
                        subtitleElement.style.opacity = 1;
                        
                    }, 800);
                    return;
                }
                subtitleElement.style.transition = "opacity 0.3s ease";

                subtitleElement.style.opacity = 0;
                setTimeout(() => {
                    currentIndex++;
                    updateSubtitle(currentIndex);
                    subtitleElement.style.opacity = 1;
                    
                }, 200);
            };
            subtitleElement.addEventListener('click', handleClick);
        }
    });
</script>